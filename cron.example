# Personal Finance Tracker - Cron Schedule Examples
#
# To use:
# 1. Copy this file: cp cron.example cron.conf
# 2. Edit paths to match your installation
# 3. Install: crontab cron.conf
#
# Format: minute hour day month weekday command

# Change this to your installation path
PROJECT_DIR=/path/to/personal-finance

# ============================================================================
# DAILY UPDATE SEQUENCE (9:00 AM - 9:15 AM)
# ============================================================================
# All updates run sequentially once per day in the correct dependency order

# STEP 1: Update FX rates (9:00 AM)
# Must run first - provides latest exchange rates for value calculations
0 9 * * * cd $PROJECT_DIR && python scripts/ingest_fx_rates.py data/portfolio.db >> logs/fx_rates.log 2>&1

# STEP 2: Ingest balances from all sources (9:05 AM)
# Depends on: FX rates (to calculate USD/IDR values)
# Fetches from exchanges, wallets, and Google Sheets
5 9 * * * cd $PROJECT_DIR && python scripts/ingest_balances.py --sources all >> logs/balances.log 2>&1

# STEP 3: Create net worth snapshot (9:10 AM)
# Depends on: Latest balances
# Calculates and stores daily assets, liabilities, net worth
10 9 * * * cd $PROJECT_DIR && python scripts/snapshot_net_worth.py >> logs/snapshot.log 2>&1

# STEP 4: Export to Google Sheets (9:15 AM)
# Depends on: Snapshot data
# Updates dashboard with latest analytics
15 9 * * * cd $PROJECT_DIR && python scripts/export_to_sheets.py >> logs/export.log 2>&1

# ============================================================================
# ALTERNATIVE SCHEDULES (All commented out by default)
# ============================================================================

# Multiple daily updates (every 6 hours)
# 0 */6 * * * cd $PROJECT_DIR && python scripts/ingest_fx_rates.py data/portfolio.db >> logs/fx_rates.log 2>&1
# 5 */6 * * * cd $PROJECT_DIR && python scripts/ingest_balances.py --sources all >> logs/balances.log 2>&1
# 10 */6 * * * cd $PROJECT_DIR && python scripts/snapshot_net_worth.py >> logs/snapshot.log 2>&1
# 15 */6 * * * cd $PROJECT_DIR && python scripts/export_to_sheets.py >> logs/export.log 2>&1

# Individual source schedules (if not using --sources all)
# 0 */4 * * * cd $PROJECT_DIR && python scripts/ingest_balances.py --sources exchanges >> logs/exchanges.log 2>&1
# 0 */4 * * * cd $PROJECT_DIR && python scripts/ingest_balances.py --sources wallets >> logs/wallets.log 2>&1
# 0 8 * * * cd $PROJECT_DIR && python scripts/ingest_balances.py --sources sheet >> logs/sheet.log 2>&1

# ============================================================================
# FUTURE ENHANCEMENTS (Scripts not yet implemented)
# ============================================================================

# CSV report exports (export_reports.py - not implemented)
# 0 22 * * * cd $PROJECT_DIR && python scripts/export_reports.py data/portfolio.db

# Database backups (backup_database.sh - not implemented)
# 0 3 * * * cd $PROJECT_DIR && ./scripts/backup_database.sh

# Data freshness monitoring (check_data_freshness.py - not implemented)
# 0 */12 * * * cd $PROJECT_DIR && python scripts/check_data_freshness.py

# ============================================================================
# NOTES
# ============================================================================
#
# Exit Codes:
#   0 = Success
#   1 = Failure (no data updated or error)
#   2 = Already running (lock file held)
#   130 = Interrupted by user
#
# Logging:
#   - Logs are written to logs/ directory
#   - Monthly rotation (fx_rates_YYYYMM.log)
#   - Cron output can be redirected: >> logs/cron.log 2>&1
#
# Lock Files:
#   - Prevents concurrent runs
#   - Located in data/ directory
#   - Auto-cleaned on successful exit
#   - If stale, manually remove: rm data/.*.lock
#
# Monitoring:
#   - Check logs regularly: tail -f logs/fx_rates_$(date +%Y%m).log
#   - Monitor cron mail for errors
#   - Set up log rotation with logrotate
#
